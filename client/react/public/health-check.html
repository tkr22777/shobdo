<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Backend Health Check - শব্দ</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@400;500;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="css/health-check.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>

<body class="health-page health-check">
    <div class="container">
        <h1>বাংলা অভিধান - Backend হেলথ চেক</h1>

        <div class="status">
            <span class="status-indicator loading"></span>
            <span id="status-text">চেকিং...</span>
        </div>

        <div id="details" class="details" style="display: none;"></div>

        <div class="home-link">
            <a href="index.html">← হোম পেজে ফিরে যান</a>
        </div>
    </div>

    <script>
        function checkBackendHealth() {
            var healthCheckRoute = "/api/v1/health";
            $.ajax({
                type: "GET",
                url: healthCheckRoute,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                timeout: 1000,
                success: function (data) {
                    $('.status-indicator').removeClass('loading').addClass('healthy');
                    $('#status-text').text('Backend সচল আছে');
                    if (data) {
                        var detailsHtml = '<h3>বিস্তারিত তথ্য:</h3>';
                        if (typeof data === 'object') {
                            detailsHtml += '<ul>';
                            for (var key in data) {
                                detailsHtml += '<li><strong>' + key + ':</strong> ' + data[key] + '</li>';
                            }
                            detailsHtml += '</ul>';
                        } else {
                            detailsHtml += '<p>' + data + '</p>';
                        }
                        $('#details').html(detailsHtml).show();
                    }
                },
                error: function (jqXHR, status, error) {
                    $('.status-indicator').removeClass('loading').addClass('unhealthy');
                    $('#status-text').text('Backend সচল নেই');
                    var errorDetails = '<h3>ত্রুটির বিবরণ:</h3>';
                    errorDetails += '<p>স্ট্যাটাস: ' + jqXHR.status + ' ' + jqXHR.statusText + '</p>';
                    if (error) { errorDetails += '<p>ত্রুটি: ' + error + '</p>'; }
                    $('#details').html(errorDetails).show();
                }
            });
        }

        $(document).ready(function () {
            setTimeout(checkBackendHealth, 500);
            $('.container').append('<button id="refresh-btn" class="button" style="margin-top: 1rem;">রিফ্রেশ</button>');
            $('#refresh-btn').click(function () {
                $('.status-indicator').removeClass('healthy unhealthy').addClass('loading');
                $('#status-text').text('চেকিং...');
                $('#details').hide();
                setTimeout(checkBackendHealth, 500);
            });
        });
    </script>
</body>

</html>
